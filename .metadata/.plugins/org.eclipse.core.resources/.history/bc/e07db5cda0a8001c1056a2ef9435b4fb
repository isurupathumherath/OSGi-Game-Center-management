package com.gamecenter.sa.osgi.managerconsumer;

import java.util.Scanner;

import org.osgi.framework.BundleActivator;
import org.osgi.framework.BundleContext;
import org.osgi.framework.ServiceReference;

import com.gamecenter.sa.osgi.gamemanageservice.GameManageService;

public class ManagerConsumerActivator implements BundleActivator {

	ServiceReference gameManagerServiceReference;
	Scanner scanner = new Scanner(System.in);
	Scanner optionScanner = new Scanner(System.in);
	boolean exit = false;

	@Override
	public void start(BundleContext bundleContext) throws Exception {
		System.out.println("============Game Center Manager Consumer Started.============");
		gameManagerServiceReference = bundleContext.getServiceReference(GameManageService.class.getName());
		GameManageService gameManageService = (GameManageService)bundleContext.getService(gameManagerServiceReference);
		
		
		
		do {
			int option = -1;
			
			String gameName, gameProvider, gameYear;
			double gamePrice;
			
			System.out.println("----------------------------Welcome to Game Center Management-------------------------------");
			
			System.out.println("");
			System.out.println("1.Add New Game");
			System.out.println("2.Update a Game");
			System.out.println("3.Delete a Game");
			System.out.println("4.Game List");
			System.out.println("5.Search Games");
			System.out.println("0.Exit");
			
			System.out.print("Please Select: ");
			option = scanner.nextInt();
			
			if(option == 0)
				exit = true;
			else if(option == 1) {
				//Get Game Name
				System.out.print("Game Name: ");
				gameName = optionScanner.nextLine();
				
				//Get Game Provider
				System.out.print("Game Provider: ");
				gameProvider = optionScanner.nextLine();
				
				//Get Game Year
				System.out.print("Game Year: ");
				gameYear = optionScanner.nextLine();
				
				//Get Game Price
				System.out.print("Game Price: ");
				gamePrice = optionScanner.nextDouble();
				
				String message = gameManageService.addGame(gameName, gameProvider, gameYear, gamePrice);
				if(message == null) {
					System.out.println("Game cannot be added");
					gameName, gameProvider, gameYear = null;
				} else {
					System.out.println(message);
				}
			}
			else if(option == 2) {
				//Get Game Name
				System.out.print("Game Name need to be updated: ");
				gameName = optionScanner.nextLine();
				
				//Get Game Provider
				System.out.print("Game Provider: ");
				gameProvider = optionScanner.nextLine();
				
				//Get Game Year
				System.out.print("Game Year: ");
				gameYear = optionScanner.nextLine();
				
				//Get Game Price
				System.out.print("Game Price: ");
				gamePrice = optionScanner.nextDouble();
				
				String message = gameManageService.addGame(gameName, gameProvider, gameYear, gamePrice);
				if(message == null) {
					System.out.println("Game cannot be added");
				} else {
					System.out.println(message);
				}
			}
		}
		while(!exit);
	}

	@Override
	public void stop(BundleContext bundleContext) throws Exception {
		System.out.println("============Game Center Manager Consumer Stopped.============");
		bundleContext.ungetService(gameManagerServiceReference);
	}

}
